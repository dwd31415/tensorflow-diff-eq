<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Differential Equations for TensorFlow</title>
      
      
      
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="Differential Equations for TensorFlow">
    <meta property="og:image" content="None/./images/icon.png">
    <meta name="apple-mobile-web-app-title" content="Differential Equations for TensorFlow">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
      <link rel="apple-touch-icon" href="./images/icon.png">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="./assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="./assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('./assets/fonts/icon.eot?52m981');
      	src: url('./assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('./assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('./assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('./assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="./assets/stylesheets/application-a422ff04cc.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
    <script src="./assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class=" ">
    
      
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
          </span>
        
        Differential Equations for TensorFlow
      </div>
    </div>
    
      
      <div class="button button-twitter" role="button" aria-label="Twitter">
        <a href="https://twitter.com/adrian_dwd" title="@adrian_dwd on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
      </div>
    
    
      
      <div class="button button-github" role="button" aria-label="GitHub">
        <a href="https://github.com/dwd31415" title="@dwd31415 on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
      </div>
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/dwd31415/tensorflow-diff-eq" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="./images/icon.png">
        </div>
      
      <div class="name">
        <strong>
          Differential Equations for TensorFlow
          <span class="version">
            
          </span>
        </strong>
        
          <br>
          dwd31415/tensorflow-diff-eq
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/dwd31415/tensorflow-diff-eq/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/dwd31415/tensorflow-diff-eq/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="current" title="Home" href=".">
      Home
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="Why TensorFlow?" href="#why-tensorflow">
                Why TensorFlow?
              </a>
            </li>
          
            <li class="anchor">
              <a title="Installation" href="#installation">
                Installation
              </a>
            </li>
          
            <li class="anchor">
              <a title="Basic Usage" href="#basic-usage">
                Basic Usage
              </a>
            </li>
          
        </ul>
      
    
  </li>

          
            
  <li>
    <a class="" title="Optimizing your Simulations" href="optim/">
      Optimizing your Simulations
    </a>
    
  </li>

          
        </ul>
        
          <hr>
          <span class="section">The author</span>
          <ul>
            
              
              <li>
                <a href="https://twitter.com/adrian_dwd" target="_blank" title="@adrian_dwd on Twitter">
                  @adrian_dwd on Twitter
                </a>
              </li>
            
            
              
              <li>
                <a href="https://github.com/dwd31415" target="_blank" title="@dwd31415 on GitHub">
                  @dwd31415 on GitHub
                </a>
              </li>
            
          </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <h1 id="welcome-to-tensorflow-diff-eq">Welcome to tensorflow-diff-eq</h1>
<p>A python package for simulating differential equations using <a href="https://www.tensorflow.org/">TensorFlow</a>. </p>
<p><img alt="Lorenz Attractor" src="https://github.com/dwd31415/tensorflow-diff-eq/blob/master/examples/lorenz_attractor_animated.gif?raw=true" /></p>
<h2 id="why-tensorflow">Why TensorFlow?</h2>
<p><a href="https://www.tensorflow.org/">TensorFlow</a> is an open source library for numerical computation(mostly in machine learning), that allows one to specify computations using abstract dataflow graphs. The library then runs them on the GPU or CPU, this makes TensorFlow great for simulating differential equations. GPUs can perform many computation much faster than CPUs, using this library one can harness this performance for simulating differential equations. The simulation can run on the GPU or the CPU without any change in code.</p>
<h2 id="installation">Installation</h2>
<p>This package is still in an early stage of development, therefore it is not yet
available from PyPI. To install it, just clone this repository and run:</p>
<div class="code"><pre>python3 setup.py install
</pre></div>


<h2 id="basic-usage">Basic Usage</h2>
<p>This package allows you to symbolically define differential equation and
simulate them using TensorFlow, this allows one to use the GPU for the actual simulation without ever using C
or CUDA. All important classes and functions are in the <code>diff_eq</code> namespace, therefore
this is best way to import tensorflow-diff-eq:</p>
<div class="code"><pre><span class="kn">import</span> <span class="nn">tensorflow_diff_eq.diff_eq</span> <span class="k">as</span> <span class="nn">diff_eq</span>
</pre></div>


<p>The first step in defining a differential equation is to create a <code>DifferentialEquation</code>
object:</p>
<div class="code"><pre><span class="n">eq</span> <span class="o">=</span> <span class="n">diff_eq</span><span class="o">.</span><span class="n">DifferentialEquation</span><span class="p">()</span>
</pre></div>


<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Partial differential equations are currently not supported (but I am working on it and contributions are always welcome).</p>
</div>
<p>Then you must specify how many quantities will be involved in your differential equation.</p>
<h3 id="example">Example:</h3>
<div class="code"><pre><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">generate_quantities</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>


<p>Once you have the references for these quantities you can define them using the
<code>define_quantity</code> function.</p>
<h3 id="example_1">Example:</h3>
<div class="code"><pre><span class="n">eq</span><span class="o">.</span><span class="n">define_quantity</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">eq</span><span class="o">.</span><span class="n">define_quantity</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">eq</span><span class="o">.</span><span class="n">define_quantity</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)(</span><span class="o">-</span><span class="n">k</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">m</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>


<p>The first argument to this function is the quantity which is being defined, the second parameter is an initial value and the third parameter is the grade of the derivative, that shall be
initialized with it. All other derivatives are initialized to zero of the respective datatype.
The forth argument is the grade of the "definition" derivative, this definition has the form
<script type="math/tex; mode=display">\frac{d^nx}{dt^n} = \phi,</script>
where <script type="math/tex">n</script> is the grade supplied as the forth argument and <script type="math/tex">\phi</script> is any expression
involving previously defined quantities or <script type="math/tex">x</script>, which is the quantity that is currently being defined. Arbitrary <script type="math/tex">n^{th}</script>-grade derivatives of the quantities are accessed using <code>.d(n)</code>, the quantity itself has to be accessed using <code>.d(0)</code>.</p>
<p>Once you have supplied the system with the differential equation in this fashion, you can start the simulation. In order to do this, you must generate a tensorflow operation that runs
the simulation. Such an operation can be generated using <code>eq.generate_simulate_operation</code> and can then be run using a tensorflow session. The function has one argument which is the <script type="math/tex">\Delta t</script> that will be used for the simulation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please make sure you run the <strong>tf.initialize_all_variables()</strong> operation after defining the quantities involved in your differential equation.</p>
</div>
<h3 id="example_2">Example:</h3>
<div class="code"><pre><span class="c"># Start tensorflow</span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">initialize_all_variables</span><span class="p">())</span>
<span class="n">simulate_op</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">generate_simulate_operation</span><span class="p">(</span><span class="mf">0.005</span><span class="p">)</span>
</pre></div>


<p>At this point you can just do <code>sess.run(simulate_op)</code> to simulate, if you want to access
any quantity at any time you can run <code>sess.run(x.d(0))</code>, where <script type="math/tex">x</script> is the quantity that you want to know the value of.</p>
<p>If you wish want to know more about how this package works, have a look at the example it the <a href="https://github.com/dwd31415/tensorflow-diff-eq/tree/master/examples">examples folder</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is quite handy to define a <em>t</em> quantity and set it's first derivative to one in order to keep track of the "time". The library does not do this for you.</p>
</div>
          <aside class="copyright" role="note">
            
              Copyright (c) 2016 Adrian Philipp Dawid &ndash;
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
    </div>
    <div class="next">
      
        <a href="optim/" title="Optimizing your Simulations">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Optimizing your Simulations
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '.';
      var repo_id  = 'dwd31415/tensorflow-diff-eq';
    </script>
    <script src="./assets/javascripts/application-997097ee0c.js"></script>
    
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', 'https://www.google-analytics.com/analytics.js', 'ga');
        /* General initialization */
        ga('create', 'UA-63855905-4', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
        /* Track outbound links */
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
        /* Register handler to log search on blur */
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    
  </body>
</html>